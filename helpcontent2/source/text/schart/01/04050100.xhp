<?xml version="1.0" encoding="UTF-8"?>

<!--
 ***********************************************************************
 *
 *  OpenOffice.org - a multi-platform office productivity suite
 *
 *  $RCSfile: 04050100.xhp,v $fileonly,v $
 *
 *  $Revision: 1.5 $
 *
 *  last change: $Author: rt $ $Date: 2008-02-19 22:40:34 $
 *
 *  The Contents of this file are made available subject to
 *  the terms of GNU Lesser General Public License Version 2.1.
 *
 *
 *    GNU Lesser General Public License Version 2.1
 *    =============================================
 *    Copyright 2005 by Sun Microsystems, Inc.
 *    901 San Antonio Road, Palo Alto, CA 94303, USA
 *
 *    This library is free software; you can redistribute it and/or
 *    modify it under the terms of the GNU Lesser General Public
 *    License version 2.1, as published by the Free Software Foundation.
 *
 *    This library is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *    Lesser General Public License for more details.
 *
 *    You should have received a copy of the GNU Lesser General Public
 *    License along with this library; if not, write to the Free Software
 *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
 *    MA  02111-1307  USA
 *
 ************************************************************************
 -->


		<helpdocument version="1.0">
<meta>
<topic id="textschart0104050100xml" indexer="include" status="PUBLISH">
<title id="tit" xml-lang="en-US">Trend Lines </title>
<filename>/text/schart/01/04050100.xhp</filename>
</topic>
</meta>
<body>
<bookmark xml-lang="en-US" branch="index" id="bm_id1744743"><bookmark_value>calculating;regression curves</bookmark_value>
<bookmark_value>regression curves in charts</bookmark_value>
<bookmark_value>trend lines in charts</bookmark_value>
<bookmark_value>mean value lines in charts</bookmark_value>
</bookmark>
<bookmark xml-lang="en-US" branch="hid/.uno:InsertTrendlines" id="bm_id2001709" localize="false"/><paragraph role="heading" id="hd_id5409405" xml-lang="en-US" level="1" l10n="CHG"><variable id="regression"><link href="text/schart/01/04050100.xhp">Trend Lines</link>
</variable></paragraph>
<paragraph role="paragraph" id="par_id7272255" xml-lang="en-US" l10n="CHG"><variable id="trendlinestext"><ahelp hid=".">Regression curves, also known as trend lines, can be added to all 2D chart types except for Pie and Stock charts.</ahelp>
</variable></paragraph>
<section id="howtoget">
  <embed href="text/schart/00/00000004.xhp#trendlines"/>
</section><comment>None</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_RB_NONE" id="bm_id2659077" localize="false"/><paragraph role="paragraph" id="par_id143436" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">No trend line is shown.</ahelp></paragraph><comment>Linear</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_RB_LINEAR" id="bm_id6944181" localize="false"/><paragraph role="paragraph" id="par_id5716727" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">A linear trend line is shown.</ahelp></paragraph><comment>Logarithmic</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_RB_LOGARITHMIC" id="bm_id886257" localize="false"/><paragraph role="paragraph" id="par_id5840021" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">A logarithmic trend line is shown.</ahelp></paragraph><comment>Exponential</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_RB_EXPONENTIAL" id="bm_id8892483" localize="false"/><paragraph role="paragraph" id="par_id9417096" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">An exponential trend line is shown.</ahelp></paragraph><comment>Power</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_RB_POWER" id="bm_id7198400" localize="false"/><paragraph role="paragraph" id="par_id8482924" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">A power trend line is shown.</ahelp></paragraph><comment>Show equation</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_SHOW_EQUATION" id="bm_id4724875" localize="false"/><paragraph role="paragraph" id="par_id8962370" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">Shows the trend line equation next to the trend line.</ahelp></paragraph><comment>Show correlation coefficient (R2)</comment>
<bookmark xml-lang="en-US" branch="hid/HID_SCH_TRENDLINE_SHOW_R_SQUARED" id="bm_id9068880" localize="false"/><paragraph role="paragraph" id="par_id6889858" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">Shows the correlation coefficient next to the trend line.</ahelp></paragraph>
<paragraph role="note" id="par_id8398998" xml-lang="en-US" l10n="CHG">If you insert a trend line to a chart type that uses categories, like <emph>Line </emph>or <emph>Column, </emph>then the numbers 1, 2, 3, <emph>…</emph> are used as x-values to calculate the trend line.</paragraph>
<list type="unordered">
<listitem>
<paragraph role="paragraph" id="par_id5676747" xml-lang="en-US" l10n="CHG">To insert trend lines for all data series, double-click the chart to enter edit mode. Choose <item type="menuitem">Insert - Trend Lines</item>, then select the type of trend line from None, Linear, Logarithmic, Exponential, or Power trend line.</paragraph>
</listitem>
<listitem>
<paragraph role="paragraph" id="par_id4349192" xml-lang="en-US" l10n="CHG">To insert a trend line for a single data series, select the data series in the chart, right-click to open the context menu, and choose <item type="menuitem">Insert - Trend Line</item>.</paragraph>
</listitem>
<listitem>
<paragraph role="paragraph" id="par_id9337443" xml-lang="en-US" l10n="NEW">To delete a single trend line or mean value line, click the line, then press the Del key.</paragraph>
</listitem>
<listitem>
<paragraph role="paragraph" id="par_id4529251" xml-lang="en-US" l10n="NEW">To delete all trend lines, choose <item type="menuitem">Insert - Trend Lines</item>, then select <emph>None</emph>.</paragraph>
</listitem>
</list>
<paragraph role="note" id="par_id296334" xml-lang="en-US" l10n="CHG">A trend line is shown in the legend automatically.</paragraph>
<bookmark xml-lang="en-US" branch="hid/.uno:InsertMeanValues" id="bm_id7854243" localize="false"/>
<bookmark xml-lang="en-US" branch="hid/.uno:InsertMeanValue" id="bm_id7854245" localize="false"/><paragraph role="paragraph" id="par_id4072084" xml-lang="en-US" l10n="NEW"><ahelp hid=".">Mean Value Lines are special trend lines that show the mean value. Use <item type="menuitem">Insert - Mean Value Lines</item> to insert mean value lines for all data series. A single mean value line can be inserted by the <emph>Insert Mean Value Line</emph> command of the context menu of a data series.</ahelp></paragraph>
<paragraph role="paragraph" id="par_id9569689" xml-lang="en-US" l10n="NEW">The trend line has the same color as the corresponding data series. To change the line properties, select the trend line and choose <item type="menuitem">Format - Object Properties - Line</item>.</paragraph>
<bookmark xml-lang="en-US" branch="hid/.uno:InsertTrendlineEquation" id="bm_id2754600" localize="false"/><paragraph role="paragraph" id="par_id846888" xml-lang="en-US" l10n="NEW"><ahelp hid=".">To show the trend line equation, select the trend line in the chart, right-click to open the context menu, and choose <emph>Insert Trend Line Equation</emph>.</ahelp></paragraph>
<paragraph role="paragraph" id="par_id8962065" xml-lang="en-US" l10n="CHG">When the chart is in edit mode, %PRODUCTNAME gives you the equation of the trend line and the correlation coefficient R². Click on the trend line to see the information in the status bar.</paragraph>
<paragraph role="note" id="par_id1328470" xml-lang="en-US" l10n="NEW">For a category chart (for example a line chart), the regression information is calculated using numbers 1, 2, 3, … as x-values. This is also true if your data series uses other numbers as names for the x-values. For such charts the XY chart type might be more suitable.</paragraph>
<paragraph role="paragraph" id="par_id8092593" xml-lang="en-US" l10n="NEW">To show the equation and the correlation coefficient, select the regression curve and choose <item type="menuitem">Format - Object Properties - Equation</item>. <comment>see http://specs.openoffice.org/chart/DisplayTrendLineEquations.odt</comment></paragraph><comment>hid</comment><paragraph role="paragraph" id="par_id7971434" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">Enable Show equation to see the equation of the regression curve.</ahelp></paragraph><comment>hid</comment><paragraph role="paragraph" id="par_id558793" xml-lang="en-US" l10n="NEW"><ahelp hid="." visibility="hidden">Enable Show correlation coefficient to see the correlation coefficient of the regression curve.</ahelp></paragraph>
<paragraph role="paragraph" id="par_id7735221" xml-lang="en-US" l10n="NEW">You can also calculate the parameters using Calc functions as follows.</paragraph>
<paragraph role="heading" id="hd_id5744193" xml-lang="en-US" level="2" l10n="NEW">The linear regression equation</paragraph>
<paragraph role="paragraph" id="par_id9251991" xml-lang="en-US" l10n="NEW">The <emph>linear regression</emph> follows the equation <item type="literal">y=m*x+b</item>.</paragraph>
<paragraph role="code" id="par_id7951902" xml-lang="en-US" l10n="NEW">m = SLOPE(Data_Y;Data_X) </paragraph>
<paragraph role="code" id="par_id6637165" xml-lang="en-US" l10n="NEW">b = INTERCEPT(Data_Y ;Data_X) </paragraph>
<paragraph role="paragraph" id="par_id7879268" xml-lang="en-US" l10n="NEW">Calculate the coefficient of determination by</paragraph>
<paragraph role="code" id="par_id9244361" xml-lang="en-US" l10n="NEW">r² = RSQ(Data_Y;Data_X) </paragraph>
<paragraph role="paragraph" id="par_id2083498" xml-lang="en-US" l10n="NEW">Besides m, b and r² the array function <emph>LINEST</emph> provides additional statistics for a regression analysis.</paragraph>
<paragraph role="heading" id="hd_id2538834" xml-lang="en-US" level="2" l10n="NEW">The logarithm regression equation</paragraph>
<paragraph role="paragraph" id="par_id394299" xml-lang="en-US" l10n="NEW">The <emph>logarithm regression</emph> follows the equation <item type="literal">y=a*ln(x)+b</item>.</paragraph>
<paragraph role="code" id="par_id2134159" xml-lang="en-US" l10n="NEW">a = SLOPE(Data_Y;LN(Data_X)) </paragraph>
<paragraph role="code" id="par_id5946531" xml-lang="en-US" l10n="NEW">b = INTERCEPT(Data_Y ;LN(Data_X)) </paragraph>
<paragraph role="code" id="par_id5649281" xml-lang="en-US" l10n="NEW">r² = RSQ(Data_Y;LN(Data_X)) </paragraph>
<paragraph role="heading" id="hd_id7874080" xml-lang="en-US" level="2" l10n="NEW">The exponential regression equation</paragraph>
<paragraph role="paragraph" id="par_id4679097" xml-lang="en-US" l10n="NEW"> For exponential regression curves a transformation to a linear model takes place. The optimal curve fitting is related to the linear model and the results are interpreted accordingly. </paragraph>
<paragraph role="paragraph" id="par_id9112216" xml-lang="en-US" l10n="NEW">The exponential regression follows the equation <item type="literal">y=b*exp(a*x)</item> or <item type="literal">y=b*m^x</item>, which is transformed to <item type="literal">ln(y)=ln(b)+a*x</item> or <item type="literal">ln(y)=ln(b)+ln(m)*x</item> respectively.</paragraph>
<paragraph role="code" id="par_id4416638" xml-lang="en-US" l10n="NEW">a = SLOPE(LN(Data_Y);Data_X) </paragraph>
<paragraph role="paragraph" id="par_id1039155" xml-lang="en-US" l10n="CHG">The variables for the second variation are calculated as follows:</paragraph>
<paragraph role="code" id="par_id7184057" xml-lang="en-US" l10n="NEW">m = EXP(SLOPE(LN(Data_Y);Data_X)) </paragraph>
<paragraph role="code" id="par_id786767" xml-lang="en-US" l10n="NEW">b = EXP(INTERCEPT(LN(Data_Y);Data_X)) </paragraph>
<paragraph role="paragraph" id="par_id7127292" xml-lang="en-US" l10n="NEW">Calculate the coefficient of determination by</paragraph>
<paragraph role="code" id="par_id5437177" xml-lang="en-US" l10n="NEW">r² = RSQ(LN(Data_Y);Data_X) </paragraph>
<paragraph role="paragraph" id="par_id6946317" xml-lang="en-US" l10n="NEW">Besides m, b and r² the array function LOGEST provides additional statistics for a regression analysis.</paragraph>
<paragraph role="heading" id="hd_id6349375" xml-lang="en-US" level="2" l10n="NEW">The power regression equation</paragraph>
<paragraph role="paragraph" id="par_id1857661" xml-lang="en-US" l10n="NEW"> For <emph>power regression</emph> curves a transformation to a linear model takes place. The power regression follows the equation <item type="literal">y=b*x^a</item> , which is transformed to <item type="literal">ln(y)=ln(b)+a*ln(x)</item>.</paragraph>
<paragraph role="code" id="par_id8517105" xml-lang="en-US" l10n="NEW">a = SLOPE(LN(Data_Y);LN(Data_X)) </paragraph>
<paragraph role="code" id="par_id9827265" xml-lang="en-US" l10n="NEW">b = EXP(INTERCEPT(LN(Data_Y);LN(Data_X)) </paragraph>
<paragraph role="code" id="par_id2357249" xml-lang="en-US" l10n="NEW">r² = RSQ(LN(Data_Y);LN(Data_X)) </paragraph>
<paragraph role="heading" id="hd_id9204077" xml-lang="en-US" level="2" l10n="NEW">Constraints<comment>UFI: is this still so?</comment></paragraph>
<paragraph role="paragraph" id="par_id7393719" xml-lang="en-US" l10n="CHG"> The calculation of the trend line considers only data pairs with the following values:</paragraph>
<list type="unordered">
<listitem>
<paragraph role="paragraph" id="par_id7212744" xml-lang="en-US" l10n="NEW">logarithm regression: only positive x-values are considered,</paragraph>
</listitem>
<listitem>
<paragraph role="paragraph" id="par_id1664479" xml-lang="en-US" l10n="NEW">exponential regression: only positive y-values are considered,</paragraph>
</listitem>
<listitem>
<paragraph role="paragraph" id="par_id8734702" xml-lang="en-US" l10n="NEW">power regression: only positive x-values and positive y-values are considered.</paragraph>
</listitem>
</list>
<paragraph role="paragraph" id="par_id181279" xml-lang="en-US" l10n="NEW">You should transform your data accordingly; it is best to work on a copy of the original data and transform the copied data.</paragraph>
<paragraph role="heading" id="hd_id7907040" xml-lang="en-US" level="2" l10n="NEW">The polynomial regression equation</paragraph>
<paragraph role="paragraph" id="par_id8918729" xml-lang="en-US" l10n="NEW">A <emph>polynomial regression</emph> curve cannot be added automatically. You must calculate this curve manually. </paragraph>
<paragraph role="paragraph" id="par_id33875" xml-lang="en-US" l10n="NEW">Create a table with the columns x, x², x³, … , xⁿ, y up to the desired degree n. </paragraph>
<paragraph role="paragraph" id="par_id8720053" xml-lang="en-US" l10n="NEW">Use the formula <item type="literal">=LINEST(Data_Y,Data_X)</item> with the complete range x to xⁿ (without headings) as Data_X. </paragraph>
<paragraph role="paragraph" id="par_id5068514" xml-lang="en-US" l10n="NEW">The first row of the LINEST output contains the coefficients of the regression polynomial, with the coefficient of xⁿ at the leftmost position.</paragraph>
<paragraph role="paragraph" id="par_id8202154" xml-lang="en-US" l10n="NEW">The first element of the third row of the LINEST output is the value of r². See the <link href="text/scalc/01/04060107.xhp#Section8">LINEST</link> function for details on proper use and an explanation of the other output parameters.</paragraph>
<section id="relatedtopics">
<paragraph role="paragraph" id="par_id4562211" xml-lang="en-US" l10n="CHG"><link href="text/schart/01/04050000.xhp">Y Error Bars tab page</link></paragraph>
</section>
</body>
</helpdocument>
